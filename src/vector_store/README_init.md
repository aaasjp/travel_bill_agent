# 知识库初始化脚本使用说明

## 概述

`init_knowledge_base.py` 是一个用于将 `data/knowledge_data` 目录下的文件自动添加到向量库中的脚本。

## 功能特性

- 🔄 自动扫描 `data/knowledge_data` 目录下的所有文件
- 📝 支持对文件内容进行智能总结（可选）
- 🗂️ 批量处理文件，提高效率
- 📊 详细的处理日志和状态报告
- ⚙️ 支持命令行参数控制行为
- 🔍 检查现有集合状态，避免重复处理

## 使用方法

### 基本使用

```bash
# 在项目根目录下运行
python src/vector_store/init_knowledge_base.py
```

### 命令行参数

```bash
# 强制重新初始化（删除现有集合）
python src/vector_store/init_knowledge_base.py --force

# 不对文件内容进行总结
python src/vector_store/init_knowledge_base.py --no-summary

# 组合使用
python src/vector_store/init_knowledge_base.py --force --no-summary
```

## 参数说明

- `--force`: 强制重新初始化，会删除现有的向量库集合
- `--no-summary`: 不对文件内容进行总结，直接存储原始内容

## 工作流程

1. **检查集合状态**: 检查向量库中是否已存在集合
2. **用户确认**: 如果集合已存在，询问用户是否继续
3. **创建集合**: 创建新的向量库集合
4. **扫描文件**: 扫描 `data/knowledge_data` 目录下的所有文件
5. **处理文件**: 批量处理文件并添加到向量库
6. **生成报告**: 输出处理结果和统计信息

## 支持的文件格式

脚本会自动处理以下类型的文件：
- PDF 文件 (.pdf)
- Word 文档 (.docx, .doc)
- 文本文件 (.txt)
- 其他文本格式文件

## 日志文件

脚本运行时会生成详细的日志文件：
- 位置: `logs/init_knowledge_base.log`
- 包含: 处理过程、成功/失败信息、错误详情

## 注意事项

1. 确保 `data/knowledge_data` 目录存在并包含要处理的文件
2. 脚本会自动跳过隐藏文件（以 `.` 开头的文件）
3. 如果文件处理失败，会在日志中记录详细错误信息
4. 建议在首次运行前备份重要的向量库数据

## 示例输出

```
==================================================
知识库初始化工具
==================================================
2024-01-01 10:00:00 - INFO - 开始知识库初始化...
2024-01-01 10:00:01 - INFO - 集合 travel_knowledge 不存在
2024-01-01 10:00:01 - INFO - 正在创建集合: travel_knowledge
2024-01-01 10:00:02 - INFO - 集合 travel_knowledge 创建成功
2024-01-01 10:00:02 - INFO - 发现文件: 国内流程说明-20250609.docx
2024-01-01 10:00:02 - INFO - 发现文件: 海尔集团政策V12.0.pdf
2024-01-01 10:00:02 - INFO - 开始处理 2 个文件...
2024-01-01 10:00:15 - INFO - 文件处理完成:
2024-01-01 10:00:15 - INFO -   成功处理: 2 个文件
2024-01-01 10:00:15 - INFO -   失败处理: 0 个文件
2024-01-01 10:00:15 - INFO - 成功处理的文件:
2024-01-01 10:00:15 - INFO -   - 国内流程说明-20250609.docx
2024-01-01 10:00:15 - INFO -   - 海尔集团政策V12.0.pdf
2024-01-01 10:00:15 - INFO - 知识库初始化完成！

✅ 知识库初始化成功！
📊 集合 'travel_knowledge' 包含 2 个文档
``` 